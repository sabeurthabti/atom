
/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _require = require('atom');

var Range = _require.Range;

var _require2 = require('./hyperclick-utils');

var defaultWordRegExpForEditor = _require2.defaultWordRegExpForEditor;

/**
 * Returns the text and range for the word that contains the given position.
 */
function getWordTextAndRange(textEditor, position, wordRegExp) {
  var textAndRange = { text: '', range: new Range(position, position) };
  wordRegExp = wordRegExp || defaultWordRegExpForEditor(textEditor);
  if (!wordRegExp) {
    return textAndRange;
  }

  var buffer = textEditor.getBuffer();
  buffer.scanInRange(wordRegExp, buffer.rangeForRow(position.row), function (data) {
    if (data.range.containsPoint(position)) {
      textAndRange = {
        text: data.matchText,
        range: data.range
      };
      data.stop();
    } else if (data.range.end.column > position.column) {
      // Stop the scan if the scanner has passed our position.
      data.stop();
    }
  });

  return textAndRange;
}

module.exports = getWordTextAndRange;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy93MS9fMm1jNm0wNTBxbjIzMm5wc2Y5ejNoZnNoNThfamgvVC90bXBpMzV6akdwdWJsaXNoX3BhY2thZ2VzL2FwbS9oeXBlcmNsaWNrL2xpYi9nZXQtd29yZC10ZXh0LWFuZC1yYW5nZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7Ozs7Ozs7Ozs7ZUFXRSxPQUFPLENBQUMsTUFBTSxDQUFDOztJQUF4QixLQUFLLFlBQUwsS0FBSzs7Z0JBQ3lCLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQzs7SUFBM0QsMEJBQTBCLGFBQTFCLDBCQUEwQjs7Ozs7QUFLL0IsU0FBUyxtQkFBbUIsQ0FDeEIsVUFBc0IsRUFDdEIsUUFBb0IsRUFDcEIsVUFBb0IsRUFBZ0M7QUFDdEQsTUFBSSxZQUFZLEdBQUcsRUFBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLEVBQUMsQ0FBQztBQUNwRSxZQUFVLEdBQUcsVUFBVSxJQUFJLDBCQUEwQixDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ2xFLE1BQUksQ0FBQyxVQUFVLEVBQUU7QUFDZixXQUFPLFlBQVksQ0FBQztHQUNyQjs7QUFFRCxNQUFJLE1BQU0sR0FBRyxVQUFVLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDcEMsUUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsTUFBTSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsVUFBQSxJQUFJLEVBQUk7QUFDdkUsUUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsRUFBRTtBQUN0QyxrQkFBWSxHQUFHO0FBQ2IsWUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTO0FBQ3BCLGFBQUssRUFBRSxJQUFJLENBQUMsS0FBSztPQUNsQixDQUFDO0FBQ0YsVUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0tBQ2IsTUFBTSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUMsTUFBTSxFQUFFOztBQUVsRCxVQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDYjtHQUNGLENBQUMsQ0FBQzs7QUFFSCxTQUFPLFlBQVksQ0FBQztDQUNyQjs7QUFFRCxNQUFNLENBQUMsT0FBTyxHQUFHLG1CQUFtQixDQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy93MS9fMm1jNm0wNTBxbjIzMm5wc2Y5ejNoZnNoNThfamgvVC90bXBpMzV6akdwdWJsaXNoX3BhY2thZ2VzL2FwbS9oeXBlcmNsaWNrL2xpYi9nZXQtd29yZC10ZXh0LWFuZC1yYW5nZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbnZhciB7UmFuZ2V9ID0gcmVxdWlyZSgnYXRvbScpO1xudmFyIHtkZWZhdWx0V29yZFJlZ0V4cEZvckVkaXRvcn0gPSByZXF1aXJlKCcuL2h5cGVyY2xpY2stdXRpbHMnKTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB0ZXh0IGFuZCByYW5nZSBmb3IgdGhlIHdvcmQgdGhhdCBjb250YWlucyB0aGUgZ2l2ZW4gcG9zaXRpb24uXG4gKi9cbmZ1bmN0aW9uIGdldFdvcmRUZXh0QW5kUmFuZ2UoXG4gICAgdGV4dEVkaXRvcjogVGV4dEVkaXRvcixcbiAgICBwb3NpdGlvbjogYXRvbSRQb2ludCxcbiAgICB3b3JkUmVnRXhwPzogP1JlZ0V4cCk6IHt0ZXh0OiBzdHJpbmc7IHJhbmdlOiBSYW5nZX0ge1xuICB2YXIgdGV4dEFuZFJhbmdlID0ge3RleHQ6ICcnLCByYW5nZTogbmV3IFJhbmdlKHBvc2l0aW9uLCBwb3NpdGlvbil9O1xuICB3b3JkUmVnRXhwID0gd29yZFJlZ0V4cCB8fCBkZWZhdWx0V29yZFJlZ0V4cEZvckVkaXRvcih0ZXh0RWRpdG9yKTtcbiAgaWYgKCF3b3JkUmVnRXhwKSB7XG4gICAgcmV0dXJuIHRleHRBbmRSYW5nZTtcbiAgfVxuXG4gIHZhciBidWZmZXIgPSB0ZXh0RWRpdG9yLmdldEJ1ZmZlcigpO1xuICBidWZmZXIuc2NhbkluUmFuZ2Uod29yZFJlZ0V4cCwgYnVmZmVyLnJhbmdlRm9yUm93KHBvc2l0aW9uLnJvdyksIGRhdGEgPT4ge1xuICAgIGlmIChkYXRhLnJhbmdlLmNvbnRhaW5zUG9pbnQocG9zaXRpb24pKSB7XG4gICAgICB0ZXh0QW5kUmFuZ2UgPSB7XG4gICAgICAgIHRleHQ6IGRhdGEubWF0Y2hUZXh0LFxuICAgICAgICByYW5nZTogZGF0YS5yYW5nZSxcbiAgICAgIH07XG4gICAgICBkYXRhLnN0b3AoKTtcbiAgICB9IGVsc2UgaWYgKGRhdGEucmFuZ2UuZW5kLmNvbHVtbiA+IHBvc2l0aW9uLmNvbHVtbikge1xuICAgICAgLy8gU3RvcCB0aGUgc2NhbiBpZiB0aGUgc2Nhbm5lciBoYXMgcGFzc2VkIG91ciBwb3NpdGlvbi5cbiAgICAgIGRhdGEuc3RvcCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHRleHRBbmRSYW5nZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBnZXRXb3JkVGV4dEFuZFJhbmdlO1xuIl19
